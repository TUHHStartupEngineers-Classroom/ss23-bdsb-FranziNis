---
title: "Tidyverse - Challenge 1"
author: "Franziska Nissen"
---

#I am hoping this works out
The following should be a code

```{r plot, fig.width=10, fig.height=7}

# CHALLENGE 1 ----
# Challenge 1.1 ----

# Step 1 - Manipulate
sales_by_loc_tbl <- bike_orderlines_wrangled_2_tbl %>%
  select(state, total.price) %>%
  group_by(state) %>%
  summarize(sales = sum(total.price)) %>%
  mutate(sales_text = scales::dollar(sales, big.mark = ".",
                                     decimal.mark = ",",
                                     prefix = "",
                                     suffix = " €"))
sales_by_loc_tbl

# Step 2 - Visualize
sales_by_loc_tbl %>%
  ggplot(aes(x = state, y = sales)) +
  geom_col(fill = "#2DC6D6") +
  #geom_label(aes(label = sales_text)) +
  #geom_smooth(method = "lm", se = FALSE) +
  scale_y_continuous(labels = scales::dollar_format(big.mark = ".", 
                                                    decimal.mark = ",", 
                                                    prefix = "", 
                                                    suffix = " €")) +
  labs(
    title = "Revenue by state", 
    x = "", 
    y = "Revenue"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```